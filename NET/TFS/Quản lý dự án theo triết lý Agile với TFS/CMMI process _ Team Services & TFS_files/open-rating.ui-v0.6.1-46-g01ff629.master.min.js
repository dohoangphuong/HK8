var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},OpenFeedback;!function(a){var b=function(){function a(){}return Object.defineProperty(a,"Instance",{get:function(){return null},enumerable:!0,configurable:!0}),a}();a.Void=b;var c=function(){function a(){this.supportLogInfo=a.checkConsoleLogFunction("info"),this.supportLogWarn=a.checkConsoleLogFunction("warn"),this.supportLogError=a.checkConsoleLogFunction("error")}return Object.defineProperty(a,"Instance",{get:function(){return null===a._instance&&(a._instance=new a),a._instance},enumerable:!0,configurable:!0}),a.checkConsoleLogFunction=function(a){return window.console&&"object"==typeof window.console&&"function"==typeof window.console[a]},a.prototype.logInfo=function(a){this.supportLogInfo&&window.console.info(a)},a.prototype.logWarning=function(a){this.supportLogWarn&&window.console.warn(a)},a.prototype.logError=function(a){this.supportLogError&&window.console.error(a)},a._instance=null,a}();a.Logger=c}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._cookiesMap=null}return Object.defineProperty(b.prototype,"cookiesMap",{get:function(){if(null===this._cookiesMap){this._cookiesMap={};for(var a=document.cookie.split(";"),b=0,c=a;b<c.length;b++){var d=c[b],e=d.indexOf("=");if(e>0){var f=d.substring(0,e),g=d.substr(e+1);this._cookiesMap[f.trim()]=g.trim()}}}return this._cookiesMap},enumerable:!0,configurable:!0}),b.prototype.retrieveCookie=function(b){return null==b?null:(this.cookiesMap[b]||a.Logger.Instance.logWarning("JY1601071438@"+b),this.cookiesMap[b]||null)},b.prototype.addCookie=function(b,c,d,e){void 0===d&&(d=null),void 0===e&&(e="/"),b&&c||a.Logger.Instance.logError("JY1601071432"),document.cookie=b+"="+c+(";path="+e)+(d?";expires="+d.toUTCString():""),this.cookiesMap[b]=c},b.prototype.removeCookie=function(b){b||a.Logger.Instance.logError("JY1601071434"),document.cookie=b+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT",delete this.cookiesMap[b]},b}();a.CookieHelper=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function a(){}return a.createEvent=function(a){var b=document.createEvent("Event");return b.initEvent(a,!0,!0),b},Object.defineProperty(a,"OpenFeedbackLayoutChangedEvent",{get:function(){return a.openFeedbackLayoutChangedEvent||(a.openFeedbackLayoutChangedEvent=a.createEvent("ofb-layoutchanged")),a.openFeedbackLayoutChangedEvent},enumerable:!0,configurable:!0}),a.fireEventAt=function(a,b){a.dispatchEvent(b)},a.openFeedbackLayoutChangedEvent=null,a}();a.EventHelper=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._cookie=new a.CookieHelper}return b.prototype.reload=function(){return this._cookie.retrieveCookie(b.CookieName)===b.CookieValue},b.prototype.persist=function(a){a?this._cookie.addCookie(b.CookieName,b.CookieValue):this._cookie.removeCookie(b.CookieName)},b.CookieName="openFeedbackIsHidden",b.CookieValue="true",b}();a.ExpandStateManager=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){function b(a){return new f(a)}function c(a,b){return new g(a,b)}var d=function(){function b(){this._result=null,this._isCompleted=!1,this._completeAction=null,this._continuationTask=null}return Object.defineProperty(b.prototype,"isCompleted",{get:function(){return this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isRunning",{get:function(){return!this.isCompleted},enumerable:!0,configurable:!0}),b.prototype.invokeContinuation=function(){this._continuationTask?this._continuationTask.invokeContinuationFunc(this._result):this._completeAction&&this._completeAction(this._result)},b.prototype.setResult=function(b){this.isRunning||a.Logger.Instance.logError("JY1512141523"),this._isCompleted=!0,this._result=b,this.invokeContinuation()},b.prototype.checkCallback=function(b){b||a.Logger.Instance.logError("JY1512141525!1"),null!==this._completeAction&&a.Logger.Instance.logWarning("JY1512141525!2"),null!==this._continuationTask&&a.Logger.Instance.logWarning("JY1512141525!3")},b.prototype.continueWith=function(a){this.checkCallback(a);var b=new e(a);return this._completeAction=null,this._continuationTask=b,this.isRunning||this.invokeContinuation(),b},b.prototype.completeWith=function(a){this.checkCallback(a),this._continuationTask=null,this._completeAction=a,this.isRunning||this.invokeContinuation()},b}();a.Task=d;var e=function(b){function c(a){b.call(this),this._continuationFunc=a}return __extends(c,b),c.prototype.invokeContinuationFunc=function(c){var d=this,e=this._continuationFunc(c);e||a.Logger.Instance.logError("JY1512141533"),e.completeWith(function(a){b.prototype.setResult.call(d,a)})},c}(d);a.TaskFromResult=b;var f=function(a){function b(b){a.call(this),a.prototype.setResult.call(this,b)}return __extends(b,a),b}(d);a.TaskWhenBoth=c;var g=function(a){function b(b,c){var d=this;a.call(this);var e,f,g=0,h=function(){2===++g&&a.prototype.setResult.call(d,[e,f])};b.completeWith(function(a){e=a,h()}),c.completeWith(function(a){f=a,h()})}return __extends(b,a),b}(d)}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){function b(){return window.openFeedbackOptions}a.getOpenFeedbackOptions=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._id=null}return b.prototype.generateId=function(){var a=("00000000"+Math.round(4294967296*Math.random()).toString(16)).substr(-8),b=("0000"+Math.round(65536*Math.random()).toString(16)).substr(-4),c=("0000"+Math.round(65536*Math.random()).toString(16)).substr(-4),d=("0000"+Math.round(65536*Math.random()).toString(16)).substr(-4),e=("000000000000"+(new Date).getTime().toString(16)).substr(-12);return a.concat(b,c,d,e)},b.prototype.retrieveOrGenerateId=function(){var b=a.getOpenFeedbackOptions().anonUserCookieName,c=new a.CookieHelper,d=c.retrieveCookie(b);if(d)return d;if(b="openFeedbackAnonUserId",d=c.retrieveCookie(b))return d;d=this.generateId();var e=new Date;return e.setUTCFullYear(e.getUTCFullYear()+1),c.addCookie(b,d,e),d},Object.defineProperty(b.prototype,"userId",{get:function(){return this._id||(this._id=this.retrieveOrGenerateId()),this._id},enumerable:!0,configurable:!0}),b}();a.UserManager=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function a(){this.width=window.innerWidth,this.height=window.innerHeight}return a}();a.UserWindowSize=b;var c=function(){function a(a){this._contract=a}return a.prototype.getContract=function(){return this._contract},a.createNew=function(c,d,e,f,g,h,i,j){return new a({anonUserId:c,documentId:d,documentSnapshotId:e||"openfeedback-anonysnap",locale:f,ratingTypeId:g,variantId:h,siteName:i,windowSize:new b,url:window.location.href,isSpam:!1,propertyBag:j&&"object"==typeof j?j:{}})},a.createUpdate=function(b,c,d){return new a({id:b,comment:c,commentExtension:d})},Object.defineProperty(a.prototype,"id",{get:function(){return this._contract.id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"typeId",{get:function(){return this._contract.ratingTypeId},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"insertedLocalTime",{get:function(){return this._contract.insertedUtcTime?new Date(this._contract.insertedUtcTime):null},enumerable:!0,configurable:!0}),a}();a.RatingItem=c;var d=function(){function b(b){void 0===b&&(b=null),this._backendUrl=b||a.getOpenFeedbackOptions().backendUrl}return b._convertNoContent=function(b){return a.Void.Instance},b._convertToRatingItem=function(a){return new c(a)},b._convertToRatingItemArray=function(a){return a.map(b._convertToRatingItem)},b.prototype.retrieveUserRatedItems=function(a,c,d,f){return new e(b._convertToRatingItemArray,"GET",this._backendUrl+"users/"+encodeURIComponent(a)+"/ratings?documentId="+encodeURIComponent(c)+"&documentSnapshotId="+(d?encodeURIComponent(d):"openfeedback-anonysnap")+"&locale="+encodeURIComponent(f))},b.prototype.addRatingItem=function(a){return new e(b._convertToRatingItem,"POST",this._backendUrl+"rating",a.getContract())},b.prototype.updateRatingItem=function(a){return new e(b._convertNoContent,"PUT",this._backendUrl+"rating/"+a.id,a.getContract())},b}();a.RatingService=d;var e=function(a){function b(b,c,d,e){var f=this;a.call(this);var g=new XMLHttpRequest;g.onreadystatechange=function(){if(g.readyState===g.DONE){var c=g.status;200!==c&&201!==c&&202!==c||!g.responseText?a.prototype.setResult.call(f,[c,null]):a.prototype.setResult.call(f,[c,b(JSON.parse(g.responseText))])}},g.open(c,d,!0),e&&g.setRequestHeader("Content-Type","application/json"),g.responseType="text",g.send(e?JSON.stringify(e):null)}return __extends(b,a),b}(a.Task);a.HttpRequest=e}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(c){if(this._locale=c,this._resource=null,c){this._locale=c.toLowerCase();var d=b.SupportedLocales.indexOf(this._locale);0>=d&&(0>d&&a.Logger.Instance.logWarning("JY1601281636@"+this._locale),this._locale=null)}}return b.prototype.convertToVoid=function(b){return this._resource=b,a.Void.Instance},b.prototype.loadResource=function(){var b=this;return this._locale?new a.HttpRequest(function(a){return b.convertToVoid(a)},"GET",""+a.getOpenFeedbackOptions().localizationUrl+this._locale+".json"):a.TaskFromResult(a.Void.Instance)},Object.defineProperty(b.prototype,"isAvailable",{get:function(){return!!this._resource},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isRtl",{get:function(){return this.isAvailable?this._resource.isRtl:!1},enumerable:!0,configurable:!0}),b.prototype.translateContainer=function(a){if(this.isAvailable){for(var b=a.querySelectorAll("[data-ofbloctxt]"),c=0;c<b.length;c++){var d=b[c];d.textContent=this._resource.texts[d.getAttribute("data-ofbloctxt")]}for(var e=a.querySelectorAll("[data-ofblochint]"),c=0;c<e.length;c++){var f=e[c];f.placeholder=this._resource.texts[f.getAttribute("data-ofblochint")]}}},b.SupportedLocales=["en-us","ar-sa","bg-bg","cs-cz","da-dk","de-de","el-gr","es-es","fa-ir","fi-fi","fil-ph","fr-fr","he-il","hu-hu","id-id","it-it","ja-jp","ko-kr","lt-lt","nb-no","nl-nl","pl-pl","pt-br","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sv-se","th-th","tr-tr","uk-ua","vi-vn","zh-cn","zh-hk","zh-tw"],b}();a.Localization=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._metadataMap=null}return Object.defineProperty(b.prototype,"metadataMap",{get:function(){if(null===this._metadataMap){this._metadataMap={};for(var a=document.getElementsByTagName("meta"),b=0;b<a.length;b++){var c=a[b],d=c.getAttribute("name");d&&(this._metadataMap[d.toLowerCase()]=c.getAttribute("content"))}}return this._metadataMap},enumerable:!0,configurable:!0}),b.prototype.retrieveMetadata=function(b){return this.metadataMap[b]||a.Logger.Instance.logWarning("JY1601261508@"+b),this.metadataMap[b]||null},b.prototype.retrieveDocumentId=function(){return this.retrieveMetadata(a.getOpenFeedbackOptions().documentMetaName.toLowerCase())},b.prototype.retrieveDocumentSnapshotId=function(){return this.retrieveMetadata(a.getOpenFeedbackOptions().documentSnapIdMetaName.toLowerCase())},b.prototype.retrieveUILocale=function(){var b=a.getOpenFeedbackOptions().uiLocale||this.retrieveLocale();return b.toLowerCase()},b.prototype.retrieveLocale=function(){return this.retrieveMetadata(a.getOpenFeedbackOptions().localeMetaName.toLowerCase())},b.prototype.retrieveSiteName=function(){return this.retrieveMetadata(a.getOpenFeedbackOptions().siteNameMetaName.toLowerCase())},b.prototype.retrieveVariantId=function(){return a.getOpenFeedbackOptions().variantId},b.prototype.retrievePropertyBag=function(){return a.getOpenFeedbackOptions().propertyBag},b}();a.MetadataHelper=b}(OpenFeedback||(OpenFeedback={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-vote"><div class="ofb-close"></div><div class="ofb-content"><div data-ofbloctxt="vote_title">Is this page helpful?</div><button class="ofb-yes" data-ofbloctxt="vote_yes">YES</button><button class="ofb-no" data-ofbloctxt="vote_no">NO</button></div><div class="ofb-mobcontent"><button class="ofb-feedback" data-ofbloctxt="vote_feedback">FEEDBACK</button></div></div>'}(b=a.vote||(a.vote={}))}(HtmlTemplates||(HtmlTemplates={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-feedback"><div class="ofb-content"><div class="ofb-close"></div><div class="ofb-form"><div class="ofb-fbsubpg"></div><h1 data-ofbloctxt="feedback_improve">How can we improve?</h1><div class="ofb-checkbox"><label><input type="checkbox"><span data-ofbloctxt="feedback_improveitem1">Fix inaccurate or outdated content</span></label></div><div class="ofb-checkbox"><label><input type="checkbox"><span data-ofbloctxt="feedback_improveitem2">Add information or more detail</span></label></div><div class="ofb-checkbox"><label><input type="checkbox"><span data-ofbloctxt="feedback_improveitem3">Fix typos or broken links</span></label></div><div class="ofb-checkbox"><label><input type="checkbox"><span data-ofbloctxt="feedback_improveitem4">Add or fix code samples</span></label></div><div class="ofb-checkbox"><label><input type="checkbox"><span data-ofbloctxt="feedback_improveitem5">Improve illustrations or images</span></label></div><h1 data-ofbloctxt="feedback_suggestion">More suggestions:</h1><div><textarea class="ofb-detail" rows="6" maxlength="1500" data-ofblochint="feedback_hint" placeholder="Please share your ideas. We welcome feedback in any language."></textarea></div><div class="ofb-submit-container"><button class="ofb-submit" data-ofbloctxt="feedback_submit">SUBMIT</button></div></div></div></div>'}(b=a.feedback||(a.feedback={}))}(HtmlTemplates||(HtmlTemplates={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<h1 data-ofbloctxt="feedback_vote">Is this page helpful?</h1><button class="ofb-yes" data-ofbloctxt="feedback_yes">YES</button><button class="ofb-no" data-ofbloctxt="feedback_no">NO</button>'}(b=a.fbnovotesubpg||(a.fbnovotesubpg={}))}(HtmlTemplates||(HtmlTemplates={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-votedtitle" data-ofbloctxt="feedback_yesdescription">It\'s great to hear you find this page helpful. If you see anything that should be fixed, please let us know.</div>'}(b=a.fbvotedyessubpg||(a.fbvotedyessubpg={}))}(HtmlTemplates||(HtmlTemplates={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-votedtitle" data-ofbloctxt="feedback_nodescription">Thank you! We\'re sorry this page did not help you. Your feedback will help us make the documentation better.</div>'}(b=a.fbvotednosubpg||(a.fbvotednosubpg={}))}(HtmlTemplates||(HtmlTemplates={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-thanksmore"><div class="ofb-close"></div><div class="ofb-content"><div class="ofb-thankyou" data-ofbloctxt="thanksmore_title">Thanks for the feedback!</div><div><span data-ofbloctxt="thanksmore_prefix">Comments or suggestions?&nbsp;</span><a class="ofb-more" unselectable="on" data-ofbloctxt="thanksmore_more">Tell us here</a><span data-ofbloctxt="thanksmore_postfix">.</span></div></div></div>'}(b=a.thanksmore||(a.thanksmore={}))}(HtmlTemplates||(HtmlTemplates={}));var HtmlTemplates;!function(a){var b;!function(a){a.html='<div class="ofb-thanks" data-ofbloctxt="thanks_title">Thanks for the feedback!</div>'}(b=a.thanks||(a.thanks={}))}(HtmlTemplates||(HtmlTemplates={}));var OpenFeedback;!function(a){function b(){return window}a.getCustomWEDCS=b;var c=function(){function b(){"function"==typeof window.MscomCustomEvent?this._instance=window:(a.Logger.Instance.logWarning("JY1601261509"),this._instance=null)}return Object.defineProperty(b.prototype,"isSupported",{get:function(){return!!this._instance},enumerable:!0,configurable:!0}),b.prototype.sendRatingItemTypeIdData=function(a,b,c){this.isSupported&&this._instance.MscomCustomEvent("wcs.cn="+a,"ms.rating="+c,"ms.feedbackid="+b,"ms.cmpgrp=feedbackform")},b.prototype.sendRatingItemData=function(a,b){this.isSupported&&this._instance.MscomCustomEvent("wcs.cn="+a,"ms.feedbackid="+b,"ms.cmpgrp=feedbackform")},b}();a.WedcsHelper=c}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(){this._voteTask=null,this._feedbackTask=null,this._voteIsHelpful=null}return Object.defineProperty(b.prototype,"isVoted",{get:function(){return null!==this._voteIsHelpful},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isHelpful",{get:function(){return this._voteIsHelpful},enumerable:!0,configurable:!0}),b.prototype.vote=function(b){if(this._voteTask)return void a.Logger.Instance.logError("JY1601291831");this._voteIsHelpful=!!b;var c=new a.UserManager,d=new a.MetadataHelper,e=new a.RatingService,f=new a.WedcsHelper;this._voteTask=e.addRatingItem(a.RatingItem.createNew(c.userId,d.retrieveDocumentId(),d.retrieveDocumentSnapshotId(),d.retrieveLocale(),b?1:0,d.retrieveVariantId(),d.retrieveSiteName(),d.retrievePropertyBag())).continueWith(function(c){var d=c[1];return d?(f.sendRatingItemTypeIdData(b?"yes":"no",d.id,d.typeId),a.TaskFromResult(d.id)):a.TaskFromResult(null)})},b.prototype.feedback=function(b,c,d){return this._voteTask?this._feedbackTask?void a.Logger.Instance.logError("JY1601291840"):void(this._feedbackTask=this._voteTask.continueWith(function(e){if(e){var f=new a.RatingService,g=new a.WedcsHelper;new a.MetadataHelper;return b?(g.sendRatingItemData("skip this",e),a.TaskFromResult(a.Void.Instance)):(g.sendRatingItemData("submit",e),c||d?f.updateRatingItem(a.RatingItem.createUpdate(e,c,d)).continueWith(function(b){return a.TaskFromResult(a.Void.Instance)}):a.TaskFromResult(a.Void.Instance))}return a.TaskFromResult(a.Void.Instance)})):void a.Logger.Instance.logError("JY1601291837")},b}();a.RatingWorkflow=b}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=function(){function b(c){this._localization=c,this._workflow=new a.RatingWorkflow,this._stateManager=new a.ExpandStateManager,this._container=document.getElementById(a.getOpenFeedbackOptions().containerElementId),this._container.classList.add(b.ContainerCssClass),c.isRtl&&(this._container.dir="rtl"),this._page=new d(this),a.EventHelper.fireEventAt(this._container,a.EventHelper.OpenFeedbackLayoutChangedEvent)}return Object.defineProperty(b.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"localization",{get:function(){return this._localization},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"workflow",{get:function(){return this._workflow},enumerable:!0,configurable:!0}),b.prototype.turnToPage=function(b){switch(this._page.desctructor(),b){case 0:this._page=new d(this);break;case 1:this._page=new e(this);break;case 2:this._page=new f(this);break;case 4:this._page=new g(this);break;case 3:this._page=new h(this)}a.EventHelper.fireEventAt(this._container,a.EventHelper.OpenFeedbackLayoutChangedEvent)},Object.defineProperty(b.prototype,"currentPage",{get:function(){return this._page.getPageType()},set:function(a){this._page.getPageType()!==a&&this.turnToPage(a)},enumerable:!0,configurable:!0}),b.ContainerCssClass="ofb-container-var111",b}();a.RatingControl=b;var c=function(){function a(a,b,c){var d=this;this._rating=a,this._root=null,this._currentHeight=-1,a.container.innerHTML=b,c&&(this._root=a.container.getElementsByClassName(c)[0],this.attachEvent("ofb-close","click",function(){return d.closingCore()})),a.localization.translateContainer(a.container)}return a.prototype.desctructor=function(){this.disposeCore()},Object.defineProperty(a.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),a.prototype.disposeCore=function(){},a.prototype.closingCore=function(){this._rating.currentPage=0},a.prototype.getElement=function(a){return this.root.getElementsByClassName(a)[0]},a.prototype.getElements=function(a){for(var b=[],c=this.root.getElementsByClassName(a),d=0;d<c.length;d++)b.push(c[d]);return b},a.prototype.attachEvent=function(a,b,c){var d=this.getElement(a);d&&d.addEventListener(b,c)},a}(),d=function(a){function b(b){a.call(this,b,"",null)}return __extends(b,a),b.prototype.getPageType=function(){return 0},b}(c),e=function(a){function b(b){var c=this;a.call(this,b,HtmlTemplates.vote.html,"ofb-vote"),this.attachEvent("ofb-yes","click",function(){return c.sendVote(!0)}),this.attachEvent("ofb-no","click",function(){return c.sendVote(!1)}),this.attachEvent("ofb-more","click",function(){return c._rating.currentPage=2}),this.attachEvent("ofb-feedback","click",function(){return c._rating.currentPage=2})}return __extends(b,a),b.prototype.getPageType=function(){return 1},b.prototype.sendVote=function(a){this._rating.workflow.vote(a),this._rating.currentPage=a?4:2},b}(c),f=function(a){function b(b){var c=this;a.call(this,b,HtmlTemplates.feedback.html,"ofb-feedback"),this.attachEvent("ofb-submit","click",function(){return c.sendDetails(!1)}),this.refreshSubPage()}return __extends(b,a),b.prototype.getPageType=function(){return 2},b.prototype.closingCore=function(){this._rating.workflow.isVoted?this.sendDetails(!0):this._rating.currentPage=1},b.prototype.sendVote=function(a){this._rating.workflow.vote(a),this.refreshSubPage()},b.prototype.sendDetails=function(a){var b=null,c=null;a||(b=this.getElement("ofb-detail").value,c=this.getElements("ofb-checkbox").filter(function(a){return a.getElementsByTagName("input")[0].checked}).map(function(a){return a.getElementsByTagName("span")[0].textContent})),this._rating.workflow.feedback(a,b,c),this._rating.currentPage=3},b.prototype.refreshSubPage=function(){var a=this;this.getElement("ofb-submit").disabled=!this._rating.workflow.isVoted;var b=this.getElement("ofb-fbsubpg");this._rating.workflow.isVoted?b.innerHTML=this._rating.workflow.isHelpful?HtmlTemplates.fbvotedyessubpg.html:HtmlTemplates.fbvotednosubpg.html:(b.innerHTML=HtmlTemplates.fbnovotesubpg.html,this.attachEvent("ofb-yes","click",function(){return a.sendVote(!0)}),this.attachEvent("ofb-no","click",function(){return a.sendVote(!1)})),this._rating.localization.translateContainer(b)},b}(c),g=function(a){function b(b){a.call(this,b,HtmlTemplates.thanksmore.html,"ofb-thanksmore");var c=window.setTimeout(function(){return b.currentPage=0},1e4);this.attachEvent("ofb-more","click",function(){window.clearTimeout(c),b.currentPage=2})}return __extends(b,a),b.prototype.getPageType=function(){return 4},b}(c),h=function(a){function b(b){a.call(this,b,HtmlTemplates.thanks.html,"ofb-thanks"),window.setTimeout(function(){return b.currentPage=0},3e3)}return __extends(b,a),b.prototype.getPageType=function(){return 3},b}(c)}(OpenFeedback||(OpenFeedback={}));var OpenFeedback;!function(a){var b=new a.MetadataHelper,c=new a.UserManager,d=new a.RatingService,e=new a.Localization(b.retrieveUILocale());a.TaskWhenBoth(e.loadResource(),d.retrieveUserRatedItems(c.userId,b.retrieveDocumentId(),b.retrieveDocumentSnapshotId(),b.retrieveLocale())).completeWith(function(b){var c=b[1][1],d=7776e6,f=(new Date).valueOf(),g=c&&c.every(function(a){return f-a.insertedLocalTime.valueOf()>d});if(g){var h=new a.RatingControl(e);h.currentPage=1}})}(OpenFeedback||(OpenFeedback={}));